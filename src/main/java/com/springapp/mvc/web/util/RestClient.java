package com.springapp.mvc.web.util;

/**
 * Created by lyp on 2015-12-22.
 * java app to connect to another API over http (JSON, RESTful)
 */


import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.alibaba.fastjson.JSON;
import org.springframework.http.*;
import org.springframework.web.client.RestTemplate;

import java.util.HashMap;
import java.util.Map;

public class RestClient {

    private RestTemplate rest;
    private HttpHeaders headers;
    private HttpStatus status;

    public RestClient() {
        this.rest = new RestTemplate();
        this.headers = new HttpHeaders();
        headers.add("Content-Type", "application/json");
        headers.add("Accept", "*/*");
    }


    /*
   * @function http get请求，参数写在uri中，参数中不能有特殊字符，比如#（锚点）
   * @param uri：请求地址，包含请求参数。示例："http://10.10.2.84:8082/devicescan/getSuggestions"
   * @return JSONObject
   * @used for ANY REQUEST FOR JSONObject without any parameter
   */
    public JSONObject getJSONObject(String uri) {
        try {
            HttpEntity<String> requestEntity = new HttpEntity<String>("", headers);
            //ResponseEntity<JSONObject> responseEntity = rest.exchange(uri, HttpMethod.GET, requestEntity, JSONObject.class);
            //this.setStatus(responseEntity.getStatusCode());
            //return responseEntity.getBody();
            String suggestions="{\"iscompress\":3,\"wd\":\"ss \",\"zoomlevel\":4,\"data\":{\"port\":[80,88,21],\"os\":[\"linux\",\"windows\",\"mac\"],\"type\":[\"camera\",\"router\",\"printer\",\"switch\"],\"country\":[\"中国\",\"Turkey\",\"USA\"],\"city\":[\"北京\",\"上海\",\"Istanbul\",\"New York\",\"南京\"]},\"statuscode\":\"200\",\"total\":56,\"took\":15,\"realsize_cluster\":31,\"errmsg\":\"\"}";
            return JSON.parseObject(suggestions);
        } catch (Exception e) {
            System.out.println("public String get(String uri) exception!");
            e.printStackTrace();
            return new JSONObject();
        }
    }

    /*
    * @function http get请求，参数写在uri中，参数中不能有特殊字符，比如#（锚点）
    * @param uri：请求地址，包含请求参数。示例："http://10.10.2.84:8082/devicescan/getLinesSegment?from=1&to=2"
    * @return JSONArray，结果为json字符串（取决去http服务器返回的数据，可能不是json）
    * @used for lines(globe)
    */
    public JSONArray getJSONArray(String uri) {
        try {
//            System.out.println(uri);
            HttpEntity<String> requestEntity = new HttpEntity<String>("", headers);
            ResponseEntity<JSONArray> responseEntity = rest.exchange(uri, HttpMethod.GET, requestEntity, JSONArray.class);
            this.setStatus(responseEntity.getStatusCode());
            return responseEntity.getBody();
        } catch (Exception e) {
            System.out.println("public String get(String uri) exception!");
            e.printStackTrace();
//            return "{\"statuscode\":\"200\",\"errmsg\":\"\",\"took\":20,\"total\":2,\"realsize\":2,\"pagesize\":10,\"currpage\":1,\"wd\":\"keyword\",\"aggregation\":{\"device_type\":{\"webcam\":2000,\"router\":500,\"gateway\":100},\"device_service\":{\"http\":2000,\"ftp\":500,\"rtmp\":100},\"country@%city\":{\"China@%BeiJing\":2000,\"China@%ShangHai\":500},\"port\":{\"22\":500,\"80\":2000},\"vul\":{\"dots_POC\":500,\"weakpwd\":2000}},\"data\":[{\"rid\":\"DS_1_2_4_8\",\"name\":\"camera_1.2.4.8\",\"tags\":[\"camera\",\"video\"],\"properties\":{\"historical_datastream\":{\"direction\":\"RES_2_USER\",\"description\":{\"comment\":\"some comments\"},\"dynamic\":true,\"name\":\"camera\",\"type\":{\"name\":\"iie\",\"org\":\"iie\"}}},\"relationship\":{},\"description\":{\"ip\":\"1.2.4.8\",\"device_category\":\"monitor\",\"device_permit\":\"control\",\"device_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"port_info\":[{\"taskId\":\"DS001\",\"port\":80,\"protocol\":\"http\",\"banner\":\"some echo information\",\"url\":[],\"status\":200,\"timestamp_sent\":1234543435,\"timestamp_received\":123243323,\"device_type\":\"webcam\",\"device_brand\":\"Hikvision\",\"device_service\":\"http\",\"device_model\":\"DE34\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"}}],\"os_info\":{\"os\":\"linux\",\"firmware\":\"20140512 building\"},\"vul_info\":[{\"taskId\":\"DS001\",\"vul_name\":\"dots_POC\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"timestamp_update\":2321421,\"vul_ID\":{\"IIE\":\"miao\",\"CVE\":\"CVE-2009_5149\",\"Bugtrag\":\"111\",\"CNVD\":\"CNVD-2009-10234\"},\"risk_level\":\"\",\"description\":\"\",\"vul_type\":\"weak_password\",\"POC_ID\":\"IIE-POC-2015-1022.py\",\"data\":{\"DBInfo\":{\"Username\":\"xxx\",\"Password\":\"xxx\",\"Salt\":\"xxx\",\"Uid\":\"xxx\",\"Groupid\":\"xxx\"},\"ShellInfo\":{\"URL\":\"xxx\",\"Content\":\"xxx\"},\"FileInfo\":{\"Filename\":\"xxx\",\"Content\":\"xxx\"},\"XSSInfo\":{\"URL\":\"xxx\",\"Payload\":\"xxx\"},\"AdminInfo\":{\"Uid\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\"},\"Database\":{\"Hostname\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\",\"DBname\":\"xxx\"},\"VerifyInfo\":{\"URL\":\"xxx\",\"Postdata\":\"xxx\",\"Path\":\"xxx\"},\"SiteAttr\":{\"Process\":\"xxx\"}},\"service\":{},\"get_picture\":\"/tmp/20151022/2.jpg\",\"get_control\":\"root/admin/http_normal_user\",\"type\":\"exploit\",\"platform\":\"Unix\",\"version\":\"0\",\"source\":\"Metasploit/exploit-db/core-security/CVE\",\"patch\":true,\"display\":-1}]}},{\"rid\":\"DS_1_2_4_9\",\"name\":\"camera_1.2.4.9\",\"tags\":[\"camera\",\"video\"],\"properties\":{\"historical_datastream\":{\"direction\":\"RES_2_USER\",\"description\":{\"comment\":\"some comments\"},\"dynamic\":true,\"name\":\"camera\",\"type\":{\"name\":\"iie\",\"org\":\"iie\"}}},\"relationship\":{},\"description\":{\"ip\":\"1.2.4.9\",\"device_category\":\"monitor\",\"device_permit\":\"control\",\"device_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"port_info\":[{\"taskId\":\"DS001\",\"port\":80,\"protocol\":\"http\",\"banner\":\"some echo information\",\"url\":[],\"status\":200,\"timestamp_sent\":1234543435,\"timestamp_received\":123243323,\"device_type\":\"webcam\",\"device_brand\":\"Hikvision\",\"device_service\":\"http\",\"device_model\":\"DE34\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"display\":-1}],\"os_info\":{\"os\":\"linux\",\"firmware\":\"20140512 building\"},\"vul_info\":[{\"taskId\":\"DS001\",\"vul_name\":\"dots_POC\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"timestamp_update\":2321421,\"vul_ID\":{\"IIE\":\"miao\",\"CVE\":\"CVE-2009_5149\",\"Bugtrag\":\"111\",\"CNVD\":\"CNVD-2009-10234\"},\"risk_level\":\"\",\"description\":\"\",\"vul_type\":\"weak_password\",\"POC_ID\":\"IIE-POC-2015-1022.py\",\"data\":{\"DBInfo\":{\"Username\":\"xxx\",\"Password\":\"xxx\",\"Salt\":\"xxx\",\"Uid\":\"xxx\",\"Groupid\":\"xxx\"},\"ShellInfo\":{\"URL\":\"xxx\",\"Content\":\"xxx\"},\"FileInfo\":{\"Filename\":\"xxx\",\"Content\":\"xxx\"},\"XSSInfo\":{\"URL\":\"xxx\",\"Payload\":\"xxx\"},\"AdminInfo\":{\"Uid\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\"},\"Database\":{\"Hostname\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\",\"DBname\":\"xxx\"},\"VerifyInfo\":{\"URL\":\"xxx\",\"Postdata\":\"xxx\",\"Path\":\"xxx\"},\"SiteAttr\":{\"Process\":\"xxx\"}},\"service\":{},\"get_picture\":\"/tmp/20151022/2.jpg\",\"get_control\":\"root/admin/http_normal_user\",\"type\":\"exploit\",\"platform\":\"Unix\",\"version\":\"0\",\"source\":\"Metasploit/exploit-db/core-security/CVE\",\"patch\":true}]}}]}";
            return new JSONArray();
        }
    }

    /*
    * @function http get请求，参数为requestParam，参数名在uri中已指定，只能为一个参数
    * @param uri：请求地址，包含请求参数。示例：http://10.10.10.10?q={q}，其中q为参数名；{q}表示参数值，必须和本方法中urlVariables的key一致
    * @param requestParam，json格式的字符串
    * @return JSONObject，结果为json字符串（取决去http服务器返回的数据，可能不是json）
    * @used for map, point(globe),advanced search
    */
    public JSONObject get(String uri, String requestParam) {
        HashMap<String, Object> urlVariables = new HashMap<String, Object>();
        urlVariables.put("q", requestParam);
        try {
            JSONObject result = rest.getForObject(uri, JSONObject.class, urlVariables);
/*            System.out.println("map or globe");
            System.out.println(result.toString());*/
            return result;
//            String tmpResponse = "{\"iscompress\":1,\"wd\":\"人\",\"zoomlevel\":4,\"data\":[{\"name\":\"DS_221_232_146_130\",\"clustersize\":1,\"description\":{\"os_info\":{},\"ip\":\"221.232.146.130\",\"device_location\":{\"country\":\"中国\",\"address\":\"\",\"code\":\"86\",\"province\":\"湖北\",\"city\":\"武汉\",\"zh_City\":\"武汉\",\"country@%city\":\"中国@%武汉\",\"zh_Pro\":\"湖北\",\"lon\":114.279121,\"es_geo\":\"30.572399,114.279121\",\"zh_CN\":\"中国\",\"lat\":30.572399},\"port_info\":[{\"vps_name\":\"ip-172-31-22-69\",\"timestamp_sent\":1451257635054,\"device_model\":\"\",\"vps_ip_internal\":\"172.31.22.69\",\"banner\":\"HTTP/1.1 200 OK\\r\\nServer: NetBox Version 2.8 Build 4128\\r\\nDate: Sun, 27 Dec 2015 22:51:06 GMT\\r\\nConnection: Keep-Alive\\r\\nSet-Cookie: JAYGNAXYUNUTLOKZUKNB=JLGZJELSHOJRHLIHKFLJFSQWLVDPWLNWHVAWXTYT; path=/\\r\\nCache-control: private\\r\\nContent-Type: text/html\\r\\nContent-Length: 12835\\r\\n\\r\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\">\\r\\n\\r\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\">\\r\\n<head>\\r\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\" />\\r\\n<title>?人???????-?????-??????????????????й??????????人???в???????????</title>\\r\\n<meta http-equiv=\\\"title\\\" content=\\\"?人???????-?????\\\">\\r\\n<meta name=\\\"description\\\" content=\\\"?人????????????1955????????人?????????????????????????????????????????????????????????????·??????????????????人???????о?????????7000????????????????3???\\\">\\r\\n<meta name=\\\"keywords\\\" content=\\\"?人??????\\\">\\r\\n<link href=\\\"css/main.css\\\" rel=\\\"stylesheet\\\" type=\\\"tex\",\"device_type\":\"camera\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":81,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451256906949}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"monitor\"},\"lastModified\":0,\"id\":\"DS_221_232_146_130\",\"tags\":[]},{\"name\":\"DS_59_106_107_186\",\"clustersize\":12,\"description\":{\"os_info\":{},\"ip\":\"59.106.107.186\",\"device_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"country@%city\":\"日本@%东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"es_geo\":\"35.699791,139.430954\",\"zh_CN\":\"日本\",\"lat\":35.699791},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451484304715,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 200 OK\\r\\nDate: Wed, 30 Dec 2015 14:05:22 GMT\\r\\nServer: Apache\\r\\nLast-Modified: Wed, 25 Nov 2015 06:09:53 GMT\\r\\nETag: \\\"22300ed-455a-525574e80ce40\\\"\\r\\nAccept-Ranges: bytes\\r\\nContent-Length: 17754\\r\\nContent-Type: text/html\\r\\n\\r\\n<!DOCTYPE html>\\n<html lang=\\\"ja\\\">\\n<head>\\n\\t<meta charset=\\\"UTF-8\\\">\\n\\t<meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge,chrome=1\\\">\\n\\t<meta name=\\\"Keywords\\\" content=\\\"グローバル,グローバル人材育成,人材育成,研修,eラーニング,英会話,語学学習\\\" />\\n\\t<title>NTTLS　グローバル人材育成 推進室</title>\\n\\t<link rel=\\\"stylesheet\\\" href=\\\"/common/css/style.css\\\">\\n\\t<link rel=\\\"stylesheet\\\" href=\\\"/css/top.css\\\">\\n\\t<script src=\\\"/common/script/jquery.js\\\"></script>\\n\\t<script src=\\\"/common/script/common.js\\\"></script>\\n\\t<script src=\\\"/script/top.js\\\"></script>\\n<script>\\n\\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\\n  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new\\nDate();a=s.createElement(o),\\n\\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.\",\"device_type\":\"DVR\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451484675258}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"monitor\"},\"lastModified\":0,\"id\":\"DS_59_106_107_186\",\"tags\":[]},{\"name\":\"DS_111_89_134_214\",\"clustersize\":113,\"description\":{\"os_info\":{},\"ip\":\"111.89.134.214\",\"device_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"日本\",\"city\":\"\",\"zh_City\":\"\",\"country@%city\":\"日本@%\",\"zh_Pro\":\"日本\",\"lon\":139.838287,\"es_geo\":\"37.487598,139.838287\",\"zh_CN\":\"日本\",\"lat\":37.487598},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451485103329,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 200 OK\\r\\nDate: Wed, 30 Dec 2015 14:05:24 GMT\\r\\nServer: Apache\\r\\nLast-Modified: Tue, 15 Dec 2015 02:27:46 GMT\\r\\nETag: \\\"c00f3c85-d59-526e688fa6c80\\\"\\r\\nAccept-Ranges: bytes\\r\\nContent-Length: 3417\\r\\nContent-Type: text/html\\r\\n\\r\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\">\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\">\\n<head>\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" />\\n<meta name=\\\"viewport\\\" content=\\\"width=1350px\\\">\\n<meta name=\\\"keywords\\\" content=\\\"モデル事務所,外人モデル,ハーフモデル,マネージメント,子供モデル\\\" />\\n<meta name=\\\"description\\\" content=\\\"東京オフィスと大阪オフィス。外人?ハーフ?日本人?子供モデルが在籍。他カメラマン?アーティストのマネージメントなど。\\\" />\\n<title>Trouver model agency</title>\\n<link href='http://fonts.googleapis.com/css?family=Josefin+Sans' rel='stylesheet' type='text/css'>\\n<script type=\\\"text/javascript\\\" src=\\\"h\",\"device_type\":\"DVR\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451484677239}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"monitor\"},\"lastModified\":0,\"id\":\"DS_111_89_134_214\",\"tags\":[]},{\"name\":\"DS_211_71_214_242\",\"clustersize\":1114,\"description\":{\"os_info\":{},\"ip\":\"211.71.214.242\",\"device_location\":{\"country\":\"中国\",\"address\":\"中国人民大学\",\"code\":\"86\",\"province\":\"北京\",\"city\":\"北京\",\"zh_City\":\"北京\",\"country@%city\":\"中国@%北京\",\"zh_Pro\":\"北京\",\"lon\":116.387909,\"es_geo\":\"39.90601,116.387909\",\"zh_CN\":\"中国\",\"lat\":39.90601},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451482314297,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 302 Moved Temporarily\\r\\nServer: DrcomServer1.0\\r\\nLocation: http://10.12.16.122\\r\\nCache-Control: no-cache\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\n\\r\\n\",\"device_type\":\"wireless\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"302\",\"timestamp_received\":1451482763289}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"security_matter\"},\"lastModified\":0,\"id\":\"DS_211_71_214_242\",\"tags\":[]},{\"name\":\"DS_211_71_214_229\",\"clustersize\":11115,\"description\":{\"os_info\":{},\"ip\":\"211.71.214.229\",\"device_location\":{\"country\":\"中国\",\"address\":\"中国人民大学\",\"code\":\"86\",\"province\":\"北京\",\"city\":\"北京\",\"zh_City\":\"北京\",\"country@%city\":\"中国@%北京\",\"zh_Pro\":\"北京\",\"lon\":116.387909,\"es_geo\":\"39.90601,116.387909\",\"zh_CN\":\"中国\",\"lat\":39.90601},\"port_info\":[{\"vps_name\":\"ip-172-31-22-69\",\"timestamp_sent\":1451487484960,\"device_model\":\"\",\"vps_ip_internal\":\"172.31.22.69\",\"banner\":\"HTTP/1.1 302 Moved Temporarily\\r\\nServer: DrcomServer1.0\\r\\nLocation: http://10.12.16.126\\r\\nCache-Control: no-cache\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\n\\r\\n\",\"device_type\":\"unknown\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"302\",\"timestamp_received\":1451486850804}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"unknown\"},\"lastModified\":0,\"id\":\"DS_211_71_214_229\",\"tags\":[]}],\"statuscode\":\"200\",\"total\":39,\"took\":66,\"realsize_cluster\":39,\"errmsg\":\"\"}";
           /* String tmpResponse = "{\"iscompress\":3,\"wd\":\"ss \",\"zoomlevel\":4,\"data\":[{\"clustersize\":5,\"description\":{\"device_location\":{\"lon\":116.387909,\"lat\":39.90601,\"country\":\"中国\",\"city\":\"北京\"}}},{\"clustersize\":4,\"description\":{\"device_location\":{\"lon\":106.522621,\"lat\":29.544001,\"country\":\"中国\",\"city\":\"重庆\"}}},{\"clustersize\":3,\"description\":{\"device_location\":{\"lon\":104.0755463,\"lat\":30.6585285,\"country\":\"中国\",\"city\":\"成都\"}}},{\"clustersize\":3,\"description\":{\"device_location\":{\"lon\":114.279121,\"lat\":30.572399,\"country\":\"中国\",\"city\":\"武汉\"}}},{\"clustersize\":3,\"description\":{\"device_location\":{\"lon\":120.34272,\"lat\":36.087509,\"country\":\"中国\",\"city\":\"青岛\"}}},{\"clustersize\":2,\"description\":{\"device_location\":{\"lon\":111.660561,\"lat\":40.82206,\"country\":\"中国\",\"city\":\"呼和浩特\"}}},{\"clustersize\":2,\"description\":{\"device_location\":{\"lon\":113.267616,\"lat\":23.107389,\"country\":\"中国\",\"city\":\"广州\"}}},{\"clustersize\":2,\"description\":{\"device_location\":{\"lon\":120.165024,\"lat\":30.252501,\"country\":\"中国\",\"city\":\"杭州\"}}},{\"clustersize\":2,\"description\":{\"device_location\":{\"lon\":118.360519,\"lat\":31.3412,\"country\":\"中国\",\"city\":\"芜湖\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":111.194618,\"lat\":34.778511,\"country\":\"中国\",\"city\":\"三门峡\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":103.759918,\"lat\":29.56921,\"country\":\"中国\",\"city\":\"乐山\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":116.482819,\"lat\":31.741011,\"country\":\"中国\",\"city\":\"六安\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":118.926003,\"lat\":32.1008,\"country\":\"中国\",\"city\":\"南京\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":115.889221,\"lat\":28.6712,\"country\":\"中国\",\"city\":\"南昌\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":112.551613,\"lat\":37.893009,\"country\":\"中国\",\"city\":\"太原\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":122.114731,\"lat\":37.497898,\"country\":\"中国\",\"city\":\"威海\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":119.52372,\"lat\":26.655701,\"country\":\"中国\",\"city\":\"宁德\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":117.190201,\"lat\":34.255489,\"country\":\"中国\",\"city\":\"徐州\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":104.375023,\"lat\":31.147209,\"country\":\"中国\",\"city\":\"德阳\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":109.46801,\"lat\":30.277,\"country\":\"中国\",\"city\":\"恩施土家族苗族自治州\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":120.288223,\"lat\":31.574011,\"country\":\"中国\",\"city\":\"无锡\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":116.96701,\"lat\":36.65551,\"country\":\"中国\",\"city\":\"济南\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":119.303223,\"lat\":26.070999,\"country\":\"中国\",\"city\":\"福州\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":122.102798,\"lat\":30.0194,\"country\":\"中国\",\"city\":\"舟山\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":120.613121,\"lat\":31.3092,\"country\":\"中国\",\"city\":\"苏州\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":112.667358,\"lat\":30.52157,\"country\":\"中国\",\"city\":\"荆州\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":119.364998,\"lat\":34.592098,\"country\":\"中国\",\"city\":\"连云港\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":113.653023,\"lat\":34.762501,\"country\":\"中国\",\"city\":\"郑州\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":125.312622,\"lat\":43.88131,\"country\":\"中国\",\"city\":\"长春\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":102.997009,\"lat\":29.990499,\"country\":\"中国\",\"city\":\"雅安\"}}},{\"clustersize\":1,\"description\":{\"device_location\":{\"lon\":139.430954,\"lat\":35.699791,\"country\":\"日本\",\"city\":\"东京\"}}}],\"statuscode\":\"200\",\"total\":56,\"took\":15,\"realsize_cluster\":31,\"errmsg\":\"\"}";
            return JSON.parseObject(tmpResponse);*/
        } catch (Exception e) {
            System.out.println("public String get(String uri, String requestParam) Exception!");
            e.printStackTrace();
//            return "{\"statuscode\":\"200\",\"errmsg\":\"\",\"took\":20,\"total\":2,\"realsize\":2,\"pagesize\":10,\"currpage\":1,\"wd\":\"keyword\",\"aggregation\":{\"device_type\":{\"webcam\":2000,\"router\":500,\"gateway\":100},\"device_service\":{\"http\":2000,\"ftp\":500,\"rtmp\":100},\"country@%city\":{\"China@%BeiJing\":2000,\"China@%ShangHai\":500},\"port\":{\"22\":500,\"80\":2000},\"vul\":{\"dots_POC\":500,\"weakpwd\":2000}},\"data\":[{\"rid\":\"DS_1_2_4_8\",\"name\":\"camera_1.2.4.8\",\"tags\":[\"camera\",\"video\"],\"properties\":{\"historical_datastream\":{\"direction\":\"RES_2_USER\",\"description\":{\"comment\":\"some comments\"},\"dynamic\":true,\"name\":\"camera\",\"type\":{\"name\":\"iie\",\"org\":\"iie\"}}},\"relationship\":{},\"description\":{\"ip\":\"1.2.4.8\",\"device_category\":[\"monitor\"],\"device_permit\":[\"controllable\",\"image_available\"],\"device_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"port_info\":[{\"taskId\":\"DS001\",\"port\":80,\"protocol\":\"http\",\"banner\":\"some echo information\",\"url\":[],\"status\":200,\"timestamp_sent\":1234543435,\"timestamp_received\":123243323,\"device_type\":\"webcam\",\"device_brand\":\"Hikvision\",\"device_service\":\"http\",\"device_model\":\"DE34\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"}}],\"os_info\":{\"os\":\"linux\",\"firmware\":\"20140512 building\"},\"vul_info\":[{\"taskId\":\"DS001\",\"vul_name\":\"dots_POC\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"timestamp_update\":2321421,\"vul_ID\":{\"IIE\":\"miao\",\"CVE\":\"CVE-2009_5149\",\"Bugtrag\":\"111\",\"CNVD\":\"CNVD-2009-10234\"},\"risk_level\":\"\",\"description\":\"\",\"vul_type\":\"weak_password\",\"POC_ID\":\"IIE-POC-2015-1022.py\",\"data\":{\"DBInfo\":{\"Username\":\"xxx\",\"Password\":\"xxx\",\"Salt\":\"xxx\",\"Uid\":\"xxx\",\"Groupid\":\"xxx\"},\"ShellInfo\":{\"URL\":\"xxx\",\"Content\":\"xxx\"},\"FileInfo\":{\"Filename\":\"xxx\",\"Content\":\"xxx\"},\"XSSInfo\":{\"URL\":\"xxx\",\"Payload\":\"xxx\"},\"AdminInfo\":{\"Uid\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\"},\"Database\":{\"Hostname\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\",\"DBname\":\"xxx\"},\"VerifyInfo\":{\"URL\":\"xxx\",\"Postdata\":\"xxx\",\"Path\":\"xxx\"},\"SiteAttr\":{\"Process\":\"xxx\"}},\"service\":{},\"get_picture\":\"/tmp/20151022/2.jpg\",\"get_control\":\"root/admin/http_normal_user\",\"type\":\"exploit\",\"platform\":\"Unix\",\"version\":\"0\",\"source\":\"Metasploit/exploit-db/core-security/CVE\",\"patch\":true,\"display\":-1}]}},{\"rid\":\"DS_1_2_4_9\",\"name\":\"camera_1.2.4.9\",\"tags\":[\"camera\",\"video\"],\"properties\":{\"historical_datastream\":{\"direction\":\"RES_2_USER\",\"description\":{\"comment\":\"some comments\"},\"dynamic\":true,\"name\":\"camera\",\"type\":{\"name\":\"iie\",\"org\":\"iie\"}}},\"relationship\":{},\"description\":{\"ip\":\"1.2.4.9\",\"device_category\":[\"monitor\"],\"device_permit\":[\"control\"],\"device_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"port_info\":[{\"taskId\":\"DS001\",\"port\":80,\"protocol\":\"http\",\"banner\":\"some echo information\",\"url\":[],\"status\":200,\"timestamp_sent\":1234543435,\"timestamp_received\":123243323,\"device_type\":\"webcam\",\"device_brand\":\"Hikvision\",\"device_service\":\"http\",\"device_model\":\"DE34\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"display\":-1}],\"os_info\":{\"os\":\"linux\",\"firmware\":\"20140512 building\"},\"vul_info\":[{\"taskId\":\"DS001\",\"vul_name\":\"dots_POC\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"timestamp_update\":2321421,\"vul_ID\":{\"IIE\":\"miao\",\"CVE\":\"CVE-2009_5149\",\"Bugtrag\":\"111\",\"CNVD\":\"CNVD-2009-10234\"},\"risk_level\":\"\",\"description\":\"\",\"vul_type\":\"weak_password\",\"POC_ID\":\"IIE-POC-2015-1022.py\",\"data\":{\"DBInfo\":{\"Username\":\"xxx\",\"Password\":\"xxx\",\"Salt\":\"xxx\",\"Uid\":\"xxx\",\"Groupid\":\"xxx\"},\"ShellInfo\":{\"URL\":\"xxx\",\"Content\":\"xxx\"},\"FileInfo\":{\"Filename\":\"xxx\",\"Content\":\"xxx\"},\"XSSInfo\":{\"URL\":\"xxx\",\"Payload\":\"xxx\"},\"AdminInfo\":{\"Uid\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\"},\"Database\":{\"Hostname\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\",\"DBname\":\"xxx\"},\"VerifyInfo\":{\"URL\":\"xxx\",\"Postdata\":\"xxx\",\"Path\":\"xxx\"},\"SiteAttr\":{\"Process\":\"xxx\"}},\"service\":{},\"get_picture\":\"/tmp/20151022/2.jpg\",\"get_control\":\"root/admin/http_normal_user\",\"type\":\"exploit\",\"platform\":\"Unix\",\"version\":\"0\",\"source\":\"Metasploit/exploit-db/core-security/CVE\",\"patch\":true}]}}]}";
            JSONObject exceptionResponse = new JSONObject();
            exceptionResponse.put("statuscode", "555");
            exceptionResponse.put("errmsg", "Cannot connect to the data server!");
            return exceptionResponse;
        }
    }

    /* ------------------ for all ----------------------- ↓ ---------------------*/
    /*
    * @function http get请求，参数为requestParam，参数名在uri中已指定，且参数名必须与requestParam中的key全部一一对应
    * @param uri：请求地址，包含请求参数。示例：http://10.10.10.10?wd={wd}&page={page}，多个参数用&连接
    * @param requestParam，Map，每一个key对应一个请求参数名，value为对应的参数值
    * @return JSONObject，结果为json字符串（取决去http服务器返回的数据，可能不是json）
    * @used for list accepting special characters，such as #,
    */
    public JSONObject get(String uri, Map<String, Object> requestParam) {
        try {
            String tmpResponse = "{\"wd\":\"人\",\"statuscode\":\"200\",\"errmsg\":\"\",\"took\":15,\"total\":45,\"realsize\":10,\"pagesize\":10,\"currpage\":1,\"aggregation\":{\"device_type\":{\"wireless\":11,\"camera\":10,\"unknown\":10,\"DVR\":7,\"NVR\":7,\"printer\":3},\"device_service\":{\"http\":41,\"manage\":4},\"country@%city\":{\"中国@%北京\":24,\"中国@%杭州\":4,\"中国@%昆明\":2,\"中国@%武汉\":2,\"中国@%深圳\":2,\"日本@%\":2,\"中国@%丽江\":1,\"中国@%宁波\":1,\"中国@%汉中\":1,\"中国@%沈阳\":1,\"中国@%绍兴\":1,\"中国@%衢州\":1,\"中国@%贵阳\":1,\"中国@%青岛\":1,\"日本@%东京\":1},\"port\":{\"80\":25,\"81\":19,\"37777\":4},\"vul\":{},\"os\":{}},\"data\":[{\"name\":\"DS_221_232_146_130\",\"description\":{\"os_info\":{},\"ip\":\"221.232.146.130\",\"device_location\":{\"country\":\"中国\",\"address\":\"\",\"code\":\"86\",\"province\":\"湖北\",\"city\":\"武汉\",\"zh_City\":\"武汉\",\"country@%city\":\"中国@%武汉\",\"zh_Pro\":\"湖北\",\"lon\":114.279121,\"es_geo\":\"30.572399,114.279121\",\"zh_CN\":\"中国\",\"lat\":30.572399},\"port_info\":[{\"vps_name\":\"ip-172-31-22-69\",\"timestamp_sent\":1451257635054,\"device_model\":\"\",\"vps_ip_internal\":\"172.31.22.69\",\"banner\":\"HTTP/1.1 200 OK\\r\\nServer: NetBox Version 2.8 Build 4128\\r\\nDate: Sun, 27 Dec 2015 22:51:06 GMT\\r\\nConnection: Keep-Alive\\r\\nSet-Cookie: JAYGNAXYUNUTLOKZUKNB=JLGZJELSHOJRHLIHKFLJFSQWLVDPWLNWHVAWXTYT; path=/\\r\\nCache-control: private\\r\\nContent-Type: text/html\\r\\nContent-Length: 12835\\r\\n\\r\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\">\\r\\n\\r\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\">\\r\\n<head>\\r\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\" />\\r\\n<title>?人???????-?????-??????????????????й??????????人???в???????????<\\/title>\\r\\n<meta http-equiv=\\\"title\\\" content=\\\"?人???????-?????\\\">\\r\\n<meta name=\\\"description\\\" content=\\\"?人????????????1955????????人?????????????????????????????????????????????????????????????·??????????????????人???????о?????????7000????????????????3???\\\">\\r\\n<meta name=\\\"keywords\\\" content=\\\"?人??????\\\">\\r\\n<link href=\\\"css/main.css\\\" rel=\\\"stylesheet\\\" type=\\\"tex\",\"device_type\":\"camera\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":81,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451256906949}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"monitor\"},\"lastModified\":0,\"id\":\"DS_221_232_146_130\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{}}},\"tags\":[]},{\"name\":\"DS_59_106_107_186\",\"description\":{\"os_info\":{},\"ip\":\"59.106.107.186\",\"device_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"country@%city\":\"日本@%东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"es_geo\":\"35.699791,139.430954\",\"zh_CN\":\"日本\",\"lat\":35.699791},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451484304715,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 200 OK\\r\\nDate: Wed, 30 Dec 2015 14:05:22 GMT\\r\\nServer: Apache\\r\\nLast-Modified: Wed, 25 Nov 2015 06:09:53 GMT\\r\\nETag: \\\"22300ed-455a-525574e80ce40\\\"\\r\\nAccept-Ranges: bytes\\r\\nContent-Length: 17754\\r\\nContent-Type: text/html\\r\\n\\r\\n<!DOCTYPE html>\\n<html lang=\\\"ja\\\">\\n<head>\\n\\t<meta charset=\\\"UTF-8\\\">\\n\\t<meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge,chrome=1\\\">\\n\\t<meta name=\\\"Keywords\\\" content=\\\"グローバル,グローバル人材育成,人材育成,研修,eラーニング,英会話,語学学習\\\" />\\n\\t<title>NTTLS　グローバル人材育成 推進室<\\/title>\\n\\t<link rel=\\\"stylesheet\\\" href=\\\"/common/css/style.css\\\">\\n\\t<link rel=\\\"stylesheet\\\" href=\\\"/css/top.css\\\">\\n\\t<script src=\\\"/common/script/jquery.js\\\"><\\/script>\\n\\t<script src=\\\"/common/script/common.js\\\"><\\/script>\\n\\t<script src=\\\"/script/top.js\\\"><\\/script>\\n<script>\\n\\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\\n  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new\\nDate();a=s.createElement(o),\\n\\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.\",\"device_type\":\"DVR\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451484675258}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"monitor\"},\"lastModified\":0,\"id\":\"DS_59_106_107_186\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{},\"direction\":\"RES_2_USER\"}},\"tags\":[]},{\"name\":\"DS_111_89_134_214\",\"description\":{\"os_info\":{},\"ip\":\"111.89.134.214\",\"device_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"日本\",\"city\":\"\",\"zh_City\":\"\",\"country@%city\":\"日本@%\",\"zh_Pro\":\"日本\",\"lon\":139.838287,\"es_geo\":\"37.487598,139.838287\",\"zh_CN\":\"日本\",\"lat\":37.487598},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451485103329,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 200 OK\\r\\nDate: Wed, 30 Dec 2015 14:05:24 GMT\\r\\nServer: Apache\\r\\nLast-Modified: Tue, 15 Dec 2015 02:27:46 GMT\\r\\nETag: \\\"c00f3c85-d59-526e688fa6c80\\\"\\r\\nAccept-Ranges: bytes\\r\\nContent-Length: 3417\\r\\nContent-Type: text/html\\r\\n\\r\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\">\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\">\\n<head>\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" />\\n<meta name=\\\"viewport\\\" content=\\\"width=1350px\\\">\\n<meta name=\\\"keywords\\\" content=\\\"モデル事務所,外人モデル,ハーフモデル,マネージメント,子供モデル\\\" />\\n<meta name=\\\"description\\\" content=\\\"東京オフィスと大阪オフィス。外人?ハーフ?日本人?子供モデルが在籍。他カメラマン?アーティストのマネージメントなど。\\\" />\\n<title>Trouver model agency<\\/title>\\n<link href='http://fonts.googleapis.com/css?family=Josefin+Sans' rel='stylesheet' type='text/css'>\\n<script type=\\\"text/javascript\\\" src=\\\"h\",\"device_type\":\"DVR\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451484677239}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"monitor\"},\"lastModified\":0,\"id\":\"DS_111_89_134_214\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{},\"direction\":\"RES_2_USER\"}},\"tags\":[]},{\"name\":\"DS_120_24_66_51\",\"description\":{\"os_info\":{},\"ip\":\"120.24.66.51\",\"device_location\":{\"country\":\"中国\",\"address\":\"\",\"code\":\"86\",\"province\":\"广东\",\"city\":\"深圳\",\"zh_City\":\"深圳\",\"country@%city\":\"中国@%深圳\",\"zh_Pro\":\"广东\",\"lon\":114.0538788,\"es_geo\":\"22.5551603,114.0538788\",\"zh_CN\":\"中国\",\"lat\":22.5551603},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451484791701,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 200 OK\\r\\nServer: Apache-Coyote/1.1\\r\\nSet-Cookie: JSESSIONID=FC4EEA2DB1A7BAF0FACAE4D015DC7491; Path=/; HttpOnly\\r\\nContent-Type: text/html;charset=utf-8\\r\\nContent-Length: 7681\\r\\nDate: Wed, 30 Dec 2015 14:07:19 GMT\\r\\n\\r\\n\\r\\n\\r\\n<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\">\\r\\n<html>\\r\\n  <head>\\r\\n    \\r\\n    <title>一搭科技<\\/title>\\r\\n    \\r\\n\\t<meta http-equiv=\\\"pragma\\\" content=\\\"no-cache\\\">\\r\\n\\t<meta http-equiv=\\\"cache-control\\\" content=\\\"no-cache\\\">\\r\\n\\t<meta http-equiv=\\\"expires\\\" content=\\\"0\\\">    \\r\\n\\t<!-- <meta http-equiv=\\\"keywords\\\" content=\\\"keyword1,keyword2,keyword3\\\">\\r\\n\\t<meta http-equiv=\\\"description\\\" content=\\\"This is my page\\\"> -->\\r\\n\\t<meta name=\\\"keywords\\\" content=\\\"一搭app,服装搭配app,衣服搭配ap,搭配技巧app,服装搭配\\\" />\\r\\n\\t<meta name=\\\"description\\\" content=\\\"一搭app是一款基于高科技人脸识别功能的时尚APP,独家发布人脸识别功能,通过对个人的数据分析向用户智能推荐专业穿搭方案,如同为每一个用户配备了专业贴身的私人造型师,一搭就时尚?\",\"device_type\":\"printer\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451485295377}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"security_matter\"},\"lastModified\":0,\"id\":\"DS_120_24_66_51\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{},\"direction\":\"RES_2_USER\"}},\"tags\":[]},{\"name\":\"DS_211_71_214_242\",\"description\":{\"os_info\":{},\"ip\":\"211.71.214.242\",\"device_location\":{\"country\":\"中国\",\"address\":\"中国人民大学\",\"code\":\"86\",\"province\":\"北京\",\"city\":\"北京\",\"zh_City\":\"北京\",\"country@%city\":\"中国@%北京\",\"zh_Pro\":\"北京\",\"lon\":116.387909,\"es_geo\":\"39.90601,116.387909\",\"zh_CN\":\"中国\",\"lat\":39.90601},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451482314297,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 302 Moved Temporarily\\r\\nServer: DrcomServer1.0\\r\\nLocation: http://10.12.16.122\\r\\nCache-Control: no-cache\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\n\\r\\n\",\"device_type\":\"wireless\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"302\",\"timestamp_received\":1451482763289}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"security_matter\"},\"lastModified\":0,\"id\":\"DS_211_71_214_242\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{},\"direction\":\"RES_2_USER\"}},\"tags\":[]},{\"name\":\"DS_211_71_214_229\",\"description\":{\"os_info\":{},\"ip\":\"211.71.214.229\",\"device_location\":{\"country\":\"中国\",\"address\":\"中国人民大学\",\"code\":\"86\",\"province\":\"北京\",\"city\":\"北京\",\"zh_City\":\"北京\",\"country@%city\":\"中国@%北京\",\"zh_Pro\":\"北京\",\"lon\":116.387909,\"es_geo\":\"39.90601,116.387909\",\"zh_CN\":\"中国\",\"lat\":39.90601},\"port_info\":[{\"vps_name\":\"ip-172-31-22-69\",\"timestamp_sent\":1451487484960,\"device_model\":\"\",\"vps_ip_internal\":\"172.31.22.69\",\"banner\":\"HTTP/1.1 302 Moved Temporarily\\r\\nServer: DrcomServer1.0\\r\\nLocation: http://10.12.16.126\\r\\nCache-Control: no-cache\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\n\\r\\n\",\"device_type\":\"unknown\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"302\",\"timestamp_received\":1451486850804}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"unknown\"},\"lastModified\":0,\"id\":\"DS_211_71_214_229\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{}}},\"tags\":[]},{\"name\":\"DS_211_71_214_245\",\"description\":{\"os_info\":{},\"ip\":\"211.71.214.245\",\"device_location\":{\"country\":\"中国\",\"address\":\"中国人民大学\",\"code\":\"86\",\"province\":\"北京\",\"city\":\"北京\",\"zh_City\":\"北京\",\"country@%city\":\"中国@%北京\",\"zh_Pro\":\"北京\",\"lon\":116.387909,\"es_geo\":\"39.90601,116.387909\",\"zh_CN\":\"中国\",\"lat\":39.90601},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451482485748,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 302 Moved Temporarily\\r\\nServer: DrcomServer1.0\\r\\nLocation: http://10.12.16.126\\r\\nCache-Control: no-cache\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\n\\r\\n\",\"device_type\":\"wireless\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"302\",\"timestamp_received\":1451482338856}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"security_matter\"},\"lastModified\":0,\"id\":\"DS_211_71_214_245\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{}}},\"tags\":[]},{\"name\":\"DS_211_71_214_234\",\"description\":{\"os_info\":{},\"ip\":\"211.71.214.234\",\"device_location\":{\"country\":\"中国\",\"address\":\"中国人民大学\",\"code\":\"86\",\"province\":\"北京\",\"city\":\"北京\",\"zh_City\":\"北京\",\"country@%city\":\"中国@%北京\",\"zh_Pro\":\"北京\",\"lon\":116.387909,\"es_geo\":\"39.90601,116.387909\",\"zh_CN\":\"中国\",\"lat\":39.90601},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451482631246,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 302 Moved Temporarily\\r\\nServer: DrcomServer1.0\\r\\nLocation: http://10.12.16.126\\r\\nCache-Control: no-cache\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\n\\r\\n\",\"device_type\":\"camera\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"302\",\"timestamp_received\":1451482969711}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"monitor\"},\"lastModified\":0,\"id\":\"DS_211_71_214_234\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{},\"direction\":\"RES_2_USER\"}},\"tags\":[]},{\"name\":\"DS_110_50_94_30\",\"description\":{\"os_info\":{},\"ip\":\"110.50.94.30\",\"device_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"日本\",\"city\":\"\",\"zh_City\":\"\",\"country@%city\":\"日本@%\",\"zh_Pro\":\"日本\",\"lon\":139.838287,\"es_geo\":\"37.487598,139.838287\",\"zh_CN\":\"日本\",\"lat\":37.487598},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451485122757,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 200 OK\\r\\nDate: Wed, 30 Dec 2015 14:05:23 GMT\\r\\nServer: Apache/2.2.3 (CentOS)\\r\\nX-Powered-By: PHP/5.1.6\\r\\nConnection: close\\r\\nTransfer-Encoding: chunked\\r\\nContent-Type: text/html\\r\\n\\r\\n217d\\r\\n<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\" \\\"http://www.w3.org/TR/html4/loose.dtd\\\">\\r\\n<html>\\r\\n<head>\\r\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=utf-8\\\">\\r\\n<meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=EmulateIE7\\\" />\\r\\n<title>札幌の専門学校?大学校｜吉田学園（北海道）<\\/title>\\r\\n<meta name=\\\"description\\\" content=\\\"吉田学園は、心の歴史に残る教育を通じて、自らの人格陶冶に努め、国際的視野に立つ個性ある人材を育成し、共に繁栄、超一流の学園を目指します。\\\">\\r\\n<meta name=\\\"keywords\\\" content=\\\"北海道,札幌,専門学校,大学校,吉田学園\\\">\\r\\n<meta http-equiv=\\\"Pragma\\\" content=\\\"no-cache\\\">\\r\\n<meta http-equiv=\\\"Cache-Control\\\" content=\\\"no-cache\\\">\\r\\n<meta http-equiv=\\\"Expires\\\" content=\\\"-1\\\">\\r\\n<meta http-equiv=\\\"Content-Styl\",\"device_type\":\"wireless\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451484654892}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"security_matter\"},\"lastModified\":0,\"id\":\"DS_110_50_94_30\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{},\"direction\":\"RES_2_USER\"}},\"tags\":[]},{\"name\":\"DS_115_182_102_30\",\"description\":{\"os_info\":{},\"ip\":\"115.182.102.30\",\"device_location\":{\"country\":\"中国\",\"address\":\"\",\"code\":\"86\",\"province\":\"北京\",\"city\":\"北京\",\"zh_City\":\"北京\",\"country@%city\":\"中国@%北京\",\"zh_Pro\":\"北京\",\"lon\":116.387909,\"es_geo\":\"39.90601,116.387909\",\"zh_CN\":\"中国\",\"lat\":39.90601},\"port_info\":[{\"vps_name\":\"dots-HVM-domU\",\"timestamp_sent\":1451484597508,\"device_model\":\"\",\"vps_ip_internal\":\"127.0.1.1\",\"banner\":\"HTTP/1.1 200 OK\\r\\nServer: nginx\\r\\nDate: Wed, 30 Dec 2015 14:05:21 GMT\\r\\nContent-Type: text/html; charset=UTF-8\\r\\nTransfer-Encoding: chunked\\r\\nConnection: keep-alive\\r\\nVary: Accept-Encoding\\r\\nSet-Cookie: _csrf=b896aa7c6b0cc13e7d8257159c0bc54dd61fe5ff8b407de5dc84d1ad0ec85274s%3A32%3A%22ACqso1gjqi-9kAf-AtqZRuD8zKBVd0-D%22%3B; path=/; httponly\\r\\n\\r\\n3e0d\\r\\n<!doctype html>\\n<html>\\n<head>\\n    <meta charset=\\\"utf-8\\\">\\n    <title>免费商标注册查询_全球更好用的商标搜索_权大师<\\/title>\\n    <meta name=\\\"csrf-param\\\" content=\\\"_csrf\\\">\\n    <meta name=\\\"csrf-token\\\" content=\\\"OVNEek1qaVZ4EDUJIlsOPEg6aUMmKw97eCc1IB8fLW5DGAYsKVpEEg==\\\">\\n    <meta name=\\\"keywords\\\" content=\\\"商标查询、商标注册、中国商标网\\\">\\n<meta name=\\\"description\\\" content=\\\"权大师商标搜索是免费的商标查询引擎，拥有中国最新最全的商标信息档案；为商标申请人、代理人降低商标注册风险，可以通过权大师搜索实时监测商标的动向。\\\">\\n<link href=\\\"/home/css/font-awesome-4.3.0/css/font-awesome.min\",\"device_type\":\"wireless\",\"url\":[],\"device_service\":\"http\",\"protocol\":\"http\",\"port\":80,\"device_brand\":\"\",\"vps_location\":{\"country\":\"日本\",\"address\":\"\",\"code\":\"81\",\"province\":\"东京都\",\"city\":\"东京\",\"zh_City\":\"东京\",\"zh_Pro\":\"东京都\",\"lon\":139.430954,\"zh_CN\":\"日本\",\"lat\":35.699791},\"vps_ip_external\":\"54.238.133.8\",\"taskId\":\"Huang_portdetect_2015-12-18 00:00:00\",\"status\":\"200\",\"timestamp_received\":1451485203375}],\"vul_info\":[],\"device_permit\":[\"accessible\"],\"device_category\":\"security_matter\"},\"lastModified\":0,\"id\":\"DS_115_182_102_30\",\"relationship\":{},\"properties\":{\"historical_datastream\":{\"name\":\"historical_datastream\",\"description\":{},\"dynamic\":false,\"type\":{},\"direction\":\"RES_2_USER\"}},\"tags\":[]}]}";
            String suggestions = "{\"iscompress\":3,\"wd\":\"ss \",\"zoomlevel\":4,\"data\":[{\"port\":[80,88,21]},{\"os\":[\"linux\",\"windows\",\"mac\"]},{\"type\":[\"camera\",\"router\",\"printer\",\"switch\"]},{\"country\":[\"中国\",\"Turkey\",\"USA\"]},{\"city\":[\"北京\",\"上海\",\"Istanbul\",\"New York\",\"南京\"]}],\"statuscode\":\"200\",\"total\":56,\"took\":15,\"realsize_cluster\":31,\"errmsg\":\"\"}";
            // JSONObject result = JSON.parseObject(tmpResponse);
            JSONObject result = JSON.parseObject(suggestions);
            //JSONObject result = rest.getForObject(uri, JSONObject.class, requestParam);
            /*System.out.println("list");
            System.out.println(result.toString());*/
            return result;
        } catch (Exception e) {
            System.out.println("public String get(String uri, Map<String, Object> requestParam) Exception!");
            e.printStackTrace();
            //return "{\"statuscode\":\"200\",\"errmsg\":\"\",\"took\":20,\"total\":2,\"realsize\":2,\"pagesize\":10,\"currpage\":1,\"wd\":\"keyword\",\"aggregation\":{\"device_type\":{\"webcam\":2000,\"router\":500,\"gateway\":100},\"device_service\":{\"http\":2000,\"ftp\":500,\"rtmp\":100},\"country@%city\":{\"China@%BeiJing\":2000,\"China@%ShangHai\":500},\"port\":{\"22\":500,\"80\":2000},\"vul\":{\"dots_POC\":500,\"weakpwd\":2000}},\"data\":[{\"rid\":\"DS_1_2_4_8\",\"name\":\"camera_1.2.4.8\",\"tags\":[\"camera\",\"video\"],\"properties\":{\"historical_datastream\":{\"direction\":\"RES_2_USER\",\"description\":{\"comment\":\"some comments\"},\"dynamic\":true,\"name\":\"camera\",\"type\":{\"name\":\"iie\",\"org\":\"iie\"}}},\"relationship\":{},\"description\":{\"ip\":\"1.2.4.8\",\"device_category\":[\"monitor\"],\"device_permit\":[\"controllable\",\"image_available\"],\"device_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"port_info\":[{\"taskId\":\"DS001\",\"port\":80,\"protocol\":\"http\",\"banner\":\"some echo information\",\"url\":[],\"status\":200,\"timestamp_sent\":1234543435,\"timestamp_received\":123243323,\"device_type\":\"webcam\",\"device_brand\":\"Hikvision\",\"device_service\":\"http\",\"device_model\":\"DE34\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"}}],\"os_info\":{\"os\":\"linux\",\"firmware\":\"20140512 building\"},\"vul_info\":[{\"taskId\":\"DS001\",\"vul_name\":\"dots_POC\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"timestamp_update\":2321421,\"vul_ID\":{\"IIE\":\"miao\",\"CVE\":\"CVE-2009_5149\",\"Bugtrag\":\"111\",\"CNVD\":\"CNVD-2009-10234\"},\"risk_level\":\"\",\"description\":\"\",\"vul_type\":\"weak_password\",\"POC_ID\":\"IIE-POC-2015-1022.py\",\"data\":{\"DBInfo\":{\"Username\":\"xxx\",\"Password\":\"xxx\",\"Salt\":\"xxx\",\"Uid\":\"xxx\",\"Groupid\":\"xxx\"},\"ShellInfo\":{\"URL\":\"xxx\",\"Content\":\"xxx\"},\"FileInfo\":{\"Filename\":\"xxx\",\"Content\":\"xxx\"},\"XSSInfo\":{\"URL\":\"xxx\",\"Payload\":\"xxx\"},\"AdminInfo\":{\"Uid\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\"},\"Database\":{\"Hostname\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\",\"DBname\":\"xxx\"},\"VerifyInfo\":{\"URL\":\"xxx\",\"Postdata\":\"xxx\",\"Path\":\"xxx\"},\"SiteAttr\":{\"Process\":\"xxx\"}},\"service\":{},\"get_picture\":\"/tmp/20151022/2.jpg\",\"get_control\":\"root/admin/http_normal_user\",\"type\":\"exploit\",\"platform\":\"Unix\",\"version\":\"0\",\"source\":\"Metasploit/exploit-db/core-security/CVE\",\"patch\":true,\"display\":-1}]}},{\"rid\":\"DS_1_2_4_9\",\"name\":\"camera_1.2.4.9\",\"tags\":[\"camera\",\"video\"],\"properties\":{\"historical_datastream\":{\"direction\":\"RES_2_USER\",\"description\":{\"comment\":\"some comments\"},\"dynamic\":true,\"name\":\"camera\",\"type\":{\"name\":\"iie\",\"org\":\"iie\"}}},\"relationship\":{},\"description\":{\"ip\":\"1.2.4.9\",\"device_category\":[\"monitor\"],\"device_permit\":[\"control\"],\"device_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"port_info\":[{\"taskId\":\"DS001\",\"port\":80,\"protocol\":\"http\",\"banner\":\"some echo information\",\"url\":[],\"status\":200,\"timestamp_sent\":1234543435,\"timestamp_received\":123243323,\"device_type\":\"webcam\",\"device_brand\":\"Hikvision\",\"device_service\":\"http\",\"device_model\":\"DE34\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"display\":-1}],\"os_info\":{\"os\":\"linux\",\"firmware\":\"20140512 building\"},\"vul_info\":[{\"taskId\":\"DS001\",\"vul_name\":\"dots_POC\",\"vps_name\":\"xen-0ther-amazon-ubuntu\",\"vps_ip_internal\":\"10.10.1.1\",\"vps_ip_external\":\"134.223.22.11\",\"vps_location\":{\"address\":\"备案地址：白云路007号\",\"city\":\"Guangzhou\",\"code\":\"CN\",\"country\":\"China\",\"lat\":23.1167,\"lon\":113.25,\"province\":\"Guangdong\",\"zh_City\":\"广州\",\"zh_CN\":\"中国\",\"zh_Pro\":\"广东\"},\"timestamp_update\":2321421,\"vul_ID\":{\"IIE\":\"miao\",\"CVE\":\"CVE-2009_5149\",\"Bugtrag\":\"111\",\"CNVD\":\"CNVD-2009-10234\"},\"risk_level\":\"\",\"description\":\"\",\"vul_type\":\"weak_password\",\"POC_ID\":\"IIE-POC-2015-1022.py\",\"data\":{\"DBInfo\":{\"Username\":\"xxx\",\"Password\":\"xxx\",\"Salt\":\"xxx\",\"Uid\":\"xxx\",\"Groupid\":\"xxx\"},\"ShellInfo\":{\"URL\":\"xxx\",\"Content\":\"xxx\"},\"FileInfo\":{\"Filename\":\"xxx\",\"Content\":\"xxx\"},\"XSSInfo\":{\"URL\":\"xxx\",\"Payload\":\"xxx\"},\"AdminInfo\":{\"Uid\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\"},\"Database\":{\"Hostname\":\"xxx\",\"Username\":\"xxx\",\"Password\":\"xxx\",\"DBname\":\"xxx\"},\"VerifyInfo\":{\"URL\":\"xxx\",\"Postdata\":\"xxx\",\"Path\":\"xxx\"},\"SiteAttr\":{\"Process\":\"xxx\"}},\"service\":{},\"get_picture\":\"/tmp/20151022/2.jpg\",\"get_control\":\"root/admin/http_normal_user\",\"type\":\"exploit\",\"platform\":\"Unix\",\"version\":\"0\",\"source\":\"Metasploit/exploit-db/core-security/CVE\",\"patch\":true}]}}]}";
            JSONObject exceptionResponse = new JSONObject();
            exceptionResponse.put("statuscode", "555");
            exceptionResponse.put("errmsg", "Cannot connect to the data server!");
            return exceptionResponse;
        }
    }

    /*
    * not in use for now
    */
    public String post(String uri, String json) {
        try {
            HttpEntity<String> requestEntity = new HttpEntity<String>(json, headers);
            ResponseEntity<String> responseEntity = rest.exchange(uri, HttpMethod.POST, requestEntity, String.class);
            this.setStatus(responseEntity.getStatusCode());
            return responseEntity.getBody();
        } catch (Exception e) {
            e.printStackTrace();
            return "Excetpion";
        }
    }

    //↓getter and setter
    public HttpStatus getStatus() {
        return status;
    }

    public void setStatus(HttpStatus status) {
        this.status = status;
    }

/*    public static void main(String[] args) {
        RestClient rc = new RestClient();
        System.out.println(rc.get("http://10.10.2.143:8083/se/search?wd={w}"));
    }*/
}